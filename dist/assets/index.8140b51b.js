import{d as F,r as O,c as S,a as T,F as j,o as A,S as R,b as U}from"./vendor.cad9b0ac.js";const D=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function f(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=f(n);fetch(n.href,r)}};D();var P=1/1048576;function B(t){var c=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r,s,u,m,y,p;for(r=t.length;r--;)t[r][0]<c&&(c=t[r][0]),t[r][0]>a&&(a=t[r][0]),t[r][1]<f&&(f=t[r][1]),t[r][1]>n&&(n=t[r][1]);return s=a-c,u=n-f,m=Math.max(s,u),y=c+s*.5,p=f+u*.5,[[y-20*m,p-m],[y,p+20*m],[y+20*m,p-m]]}function C(t,c,f,a){var n=t[c][0],r=t[c][1],s=t[f][0],u=t[f][1],m=t[a][0],y=t[a][1],p=Math.abs(r-u),_=Math.abs(u-y),b,M,x,i,e,h,d,o,l,g;if(p<P&&_<P)throw new Error("Eek! Coincident points!");return p<P?(i=-((m-s)/(y-u)),h=(s+m)/2,o=(u+y)/2,b=(s+n)/2,M=i*(b-h)+o):_<P?(x=-((s-n)/(u-r)),e=(n+s)/2,d=(r+u)/2,b=(m+s)/2,M=x*(b-e)+d):(x=-((s-n)/(u-r)),i=-((m-s)/(y-u)),e=(n+s)/2,h=(s+m)/2,d=(r+u)/2,o=(u+y)/2,b=(x*e-i*h+o-d)/(x-i),M=p>_?x*(b-e)+d:i*(b-h)+o),l=s-b,g=u-M,{i:c,j:f,k:a,x:b,y:M,r:l*l+g*g}}function V(t){var c,f,a,n,r,s;for(f=t.length;f;)for(n=t[--f],a=t[--f],c=f;c;)if(s=t[--c],r=t[--c],a===r&&n===s||a===s&&n===r){t.splice(f,2),t.splice(c,2);break}}var Y={triangulate:function(t,c){var f=t.length,a,n,r,s,u,m,y,p,_,b,M,x;if(f<3)return[];if(t=t.slice(0),c)for(a=f;a--;)t[a]=t[a][c];for(r=new Array(f),a=f;a--;)r[a]=a;for(r.sort(function(i,e){var h=t[e][0]-t[i][0];return h!==0?h:i-e}),s=B(t),t.push(s[0],s[1],s[2]),u=[C(t,f+0,f+1,f+2)],m=[],y=[],a=r.length;a--;y.length=0){for(x=r[a],n=u.length;n--;){if(p=t[x][0]-u[n].x,p>0&&p*p>u[n].r){m.push(u[n]),u.splice(n,1);continue}_=t[x][1]-u[n].y,!(p*p+_*_-u[n].r>P)&&(y.push(u[n].i,u[n].j,u[n].j,u[n].k,u[n].k,u[n].i),u.splice(n,1))}for(V(y),n=y.length;n;)M=y[--n],b=y[--n],u.push(C(t,b,M,x))}for(a=u.length;a--;)m.push(u[a]);for(u.length=0,a=m.length;a--;)m[a].i<f&&m[a].j<f&&m[a].k<f&&u.push(m[a].i,m[a].j,m[a].k);return u},contains:function(t,c){if(c[0]<t[0][0]&&c[0]<t[1][0]&&c[0]<t[2][0]||c[0]>t[0][0]&&c[0]>t[1][0]&&c[0]>t[2][0]||c[1]<t[0][1]&&c[1]<t[1][1]&&c[1]<t[2][1]||c[1]>t[0][1]&&c[1]>t[1][1]&&c[1]>t[2][1])return null;var f=t[1][0]-t[0][0],a=t[2][0]-t[0][0],n=t[1][1]-t[0][1],r=t[2][1]-t[0][1],s=f*r-a*n;if(s===0)return null;var u=(r*(c[0]-t[0][0])-a*(c[1]-t[0][1]))/s,m=(f*(c[1]-t[0][1])-n*(c[0]-t[0][0]))/s;return u<0||m<0||u+m>1?null:[u,m]}};const $=F({setup(t,{expose:c}){let f;function a(i,e,h,d){let o=i.data,l=(d*h+e)*4;var g=o[l],w=o[l+1],I=o[l+2],N=o[l+3];return[g,w,I,N]}async function n(i){let e=new Image;const h=URL.createObjectURL(i);e.src=h,await new Promise((N,E)=>{e.onload=()=>N({}),e.onerror=()=>E(Error("Image loading error"))});let o=e.width,l=e.height;const g=document.createElement("canvas");o*l>1024*1024&&(o>l?(l=1024*l/o,o=1024):(o=1024*o/l,l=1024)),g.width=o,g.height=l;const w=g.getContext("2d");if(!w)throw new Error("Could not create canvas context");return URL.revokeObjectURL(h),w.drawImage(e,0,0,e.width,e.height,0,0,o,l),w.getImageData(0,0,o,l)}function r(i,e){let h=1,d=[],o=i.width,l=i.height,g=e.data;for(let E=0;E<l;E+=h)for(let L=0;L<o;L+=h){let k=(o*E+L)*4;var w=g[k],I=g[k+1],N=g[k+2];w+I+N<=255||d.push([L,E])}return d}function s(i,e){let h=[],d=[];for(let o=0;o<e;o++){let l=Math.floor(Math.random()*i.length);for(;d.includes(l);)l=Math.floor(Math.random()*i.length),d.push(l);h.push(i[l])}return h}function u(i,e){let h=i.width-1,d=i.height-1,o=e-4,l=[],g=[];g=[[0,0],[0,d],[h,0],[h,d]];for(let w=0;w<o;w++){let I=Math.floor(Math.random()*h),N=Math.floor(Math.random()*d),E=[I,N],L=E.toString();for(;l.includes(L);)I=Math.floor(Math.random()*h),N=Math.floor(Math.random()*d),E=[I,N],L=E.toString(),l.push(L);g.push(E)}return g}async function m(i){let e=await n(i),h=e.width*e.height/100,d=h*9/10,o=h*1/10,g=R(e).toImageData(),w=r(e,g),I=s(w,d),N=u(e,o);return{imageData:e,pointData:N.concat(I)}}async function y(i){let e=document.createElement("canvas"),h=e.getContext("2d"),{imageData:d,pointData:o}=await m(i);e.width=d.width,e.height=d.height,h.putImageData(d,0,0),e.style.cssText="width: 48%",document.body.appendChild(e),p(d,o)}function p(i,e){let h=document.createElement("canvas"),d=h.getContext("2d");h.width=i.width,h.height=i.height;for(var o=Y.triangulate(e),l=o.length;l;){d.beginPath(),--l,d.moveTo(e[o[l]][0],e[o[l]][1]);let g=a(i,e[o[l]][0],e[o[l]][1],i.width);--l,d.lineTo(e[o[l]][0],e[o[l]][1]);let w=a(i,e[o[l]][0],e[o[l]][1],i.width);--l,d.lineTo(e[o[l]][0],e[o[l]][1]);let I=a(i,e[o[l]][0],e[o[l]][1],i.width),N=(g[0]+w[0]+I[0])/3,E=(g[1]+w[1]+I[1])/3,L=(g[2]+w[2]+I[2])/3,k=`rgba(${N}, ${E}, ${L}, ${g[3]})`;d.fillStyle=k,d.strokeStyle=k,d.fill(),d.closePath(),d.stroke()}h.style.cssText="width: 48%;margin-left: 4%",h.toBlob(g=>{f=g}),document.body.appendChild(h)}const _=O(),b=()=>{_.value.click()},M=i=>{let e=i.target.files;y(e[0])},x=()=>{var i=document.createElement("a"),e=window.URL.createObjectURL(f);i.href=e,i.download=Math.floor(Math.random()*1e5)+".png",i.click(),window.URL.revokeObjectURL(e)};return c({selectFile:b,saveToImg:x,changeFile:M}),(i,e)=>(A(),S(j,null,[T("div",{class:"btn",onClick:b},"\u9009\u62E9\u56FE\u7247"),T("div",{class:"btn",style:{left:"calc(80% - 80px)"},onClick:x},"\u5B58\u4E3A\u56FE\u7247"),T("input",{type:"file",ref_key:"selector",ref:_,style:{display:"none"},onChange:M},null,544)],64))}});U($).mount("#app");

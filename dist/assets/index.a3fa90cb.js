import{d as te,r as E,o as G,c as Y,a as c,w as H,v as ee,t as X,b as oe,F as J,n as se,S as ie,e as Z,f as ae,g as le,h as ce,i as ne,u as Q,j as de}from"./vendor.75865f18.js";const he=function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(t){if(t.ep)return;t.ep=!0;const a=r(t);fetch(t.href,a)}};he();var W=1/1048576;function fe(e){var l=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,t=Number.NEGATIVE_INFINITY,a,i,s,u,m,w;for(a=e.length;a--;)e[a][0]<l&&(l=e[a][0]),e[a][0]>o&&(o=e[a][0]),e[a][1]<r&&(r=e[a][1]),e[a][1]>t&&(t=e[a][1]);return i=o-l,s=t-r,u=Math.max(i,s),m=l+i*.5,w=r+s*.5,[[m-20*u,w-u],[m,w+20*u],[m+20*u,w-u]]}function ue(e,l,r,o){var t=e[l][0],a=e[l][1],i=e[r][0],s=e[r][1],u=e[o][0],m=e[o][1],w=Math.abs(a-s),C=Math.abs(s-m),N,D,M,y,R,P,O,z,_,p;if(w<W&&C<W)throw new Error("Eek! Coincident points!");return w<W?(y=-((u-i)/(m-s)),P=(i+u)/2,z=(s+m)/2,N=(i+t)/2,D=y*(N-P)+z):C<W?(M=-((i-t)/(s-a)),R=(t+i)/2,O=(a+s)/2,N=(u+i)/2,D=M*(N-R)+O):(M=-((i-t)/(s-a)),y=-((u-i)/(m-s)),R=(t+i)/2,P=(i+u)/2,O=(a+s)/2,z=(s+m)/2,N=(M*R-y*P+z-O)/(M-y),D=w>C?M*(N-R)+O:y*(N-P)+z),_=i-N,p=s-D,{i:l,j:r,k:o,x:N,y:D,r:_*_+p*p}}function ge(e){var l,r,o,t,a,i;for(r=e.length;r;)for(t=e[--r],o=e[--r],l=r;l;)if(i=e[--l],a=e[--l],o===a&&t===i||o===i&&t===a){e.splice(r,2),e.splice(l,2);break}}var re={triangulate:function(e,l){var r=e.length,o,t,a,i,s,u,m,w,C,N,D,M;if(r<3)return[];if(e=e.slice(0),l)for(o=r;o--;)e[o]=e[o][l];for(a=new Array(r),o=r;o--;)a[o]=o;for(a.sort(function(y,R){var P=e[R][0]-e[y][0];return P!==0?P:y-R}),i=fe(e),e.push(i[0],i[1],i[2]),s=[ue(e,r+0,r+1,r+2)],u=[],m=[],o=a.length;o--;m.length=0){for(M=a[o],t=s.length;t--;){if(w=e[M][0]-s[t].x,w>0&&w*w>s[t].r){u.push(s[t]),s.splice(t,1);continue}C=e[M][1]-s[t].y,!(w*w+C*C-s[t].r>W)&&(m.push(s[t].i,s[t].j,s[t].j,s[t].k,s[t].k,s[t].i),s.splice(t,1))}for(ge(m),t=m.length;t;)D=m[--t],N=m[--t],s.push(ue(e,N,D,M))}for(o=s.length;o--;)u.push(s[o]);for(s.length=0,o=u.length;o--;)u[o].i<r&&u[o].j<r&&u[o].k<r&&s.push(u[o].i,u[o].j,u[o].k);return s},contains:function(e,l){if(l[0]<e[0][0]&&l[0]<e[1][0]&&l[0]<e[2][0]||l[0]>e[0][0]&&l[0]>e[1][0]&&l[0]>e[2][0]||l[1]<e[0][1]&&l[1]<e[1][1]&&l[1]<e[2][1]||l[1]>e[0][1]&&l[1]>e[1][1]&&l[1]>e[2][1])return null;var r=e[1][0]-e[0][0],o=e[2][0]-e[0][0],t=e[1][1]-e[0][1],a=e[2][1]-e[0][1],i=r*a-o*t;if(i===0)return null;var s=(a*(l[0]-e[0][0])-o*(l[1]-e[0][1]))/i,u=(r*(l[1]-e[0][1])-t*(l[0]-e[0][0]))/i;return s<0||u<0||s+u>1?null:[s,u]}};const me={class:"show-box"},ve={class:"bottom-box"},pe={class:"slider"},_e={class:"slider-input"},be=["min","max"],ye={class:"slider-input"},we=te({emits:["changeMode"],setup(e,{expose:l,emit:r}){let o={originFile:null,imageData:null,saveData:null};function t(){o={originFile:null,imageData:null,saveData:null}}function a(d,n,h,v){let f=d.data,g=(v*h+n)*4;var F=f[g],A=f[g+1],$=f[g+2],U=f[g+3];return[F,A,$,U]}function i(d){return d<1?Math.round(d*1e3)/1e3:Math.round(d)}async function s(d){let n=new Image;const h=URL.createObjectURL(d);n.src=h,await new Promise((U,B)=>{n.onload=()=>U({}),n.onerror=()=>B(Error("Image loading error"))});let f=n.width,g=n.height;const F=document.createElement("canvas");f*g>1024*1024&&(f>g?(g=1024*g/f,f=1024):(f=1024*f/g,g=1024)),F.width=f,F.height=g;const A=F.getContext("2d");if(!A)throw new Error("Could not create canvas context");return URL.revokeObjectURL(h),A.drawImage(n,0,0,n.width,n.height,0,0,f,g),A.getImageData(0,0,f,g)}const u=E(!1),m=E([0,1e3]),w=E(1),C=E(1);function N(){u.value=!1,m.value=[0,1e3],w.value=1,C.value=1}function D(d,n){let h=1,v=[],f=d.width,g=d.height,F=n.data;for(let B=0;B<g;B+=h)for(let q=0;q<f;q+=h){let K=(f*B+q)*4;var A=F[K],$=F[K+1],U=F[K+2];A+$+U<=255||v.push([q,B])}return v}function M(d,n){let h=[],v=[];for(let f=0;f<n;f++){let g=Math.floor(Math.random()*d.length);for(;v.includes(g);)g=Math.floor(Math.random()*d.length),v.push(g);h.push(d[g])}return h}function y(d,n){let h=d.width-1,v=d.height-1,f=n-4,g=[],F=[];F=[[0,0],[0,v],[h,0],[h,v]];for(let A=0;A<f;A++){let $=Math.floor(Math.random()*h),U=Math.floor(Math.random()*v),B=[$,U],q=B.toString();for(;g.includes(q);)$=Math.floor(Math.random()*h),U=Math.floor(Math.random()*v),B=[$,U],q=B.toString(),g.push(q);F.push(B)}return F}async function R(d){let n,h,v,f;o.imageData?(console.log("use cache"),n=o.imageData):(n=await s(d),o.imageData=n),h=n.width*n.height/100,m.value=[h/10,h],v=h*90,f=h*10,u.value?(v=w.value*C.value,f=w.value*(100-C.value)):se(()=>{w.value=h,C.value=90});let F=ie(n).toImageData(),A=D(n,F),$=M(A,v/100),U=y(n,f/100);return{imageData:n,pointData:U.concat($)}}function P(){p.value.innerHTML="",k.value.innerHTML=""}async function O(d){let n=document.createElement("canvas"),h=n.getContext("2d"),{imageData:v,pointData:f}=await R(d);n.width=v.width,n.height=v.height,h.putImageData(v,0,0),p.value.appendChild(n),z(v,f)}function z(d,n){let h=document.createElement("canvas"),v=h.getContext("2d");h.width=d.width,h.height=d.height;for(var f=re.triangulate(n),g=f.length;g;){v.beginPath(),--g,v.moveTo(n[f[g]][0],n[f[g]][1]);let F=a(d,n[f[g]][0],n[f[g]][1],d.width);--g,v.lineTo(n[f[g]][0],n[f[g]][1]);let A=a(d,n[f[g]][0],n[f[g]][1],d.width);--g,v.lineTo(n[f[g]][0],n[f[g]][1]);let $=a(d,n[f[g]][0],n[f[g]][1],d.width),U=(F[0]+A[0]+$[0])/3,B=(F[1]+A[1]+$[1])/3,q=(F[2]+A[2]+$[2])/3,K=`rgba(${U}, ${B}, ${q}, ${F[3]})`;v.fillStyle=K,v.strokeStyle=K,v.fill(),v.closePath(),v.stroke()}h.toBlob(F=>{o.saveData=F}),k.value.appendChild(h)}const _=E(),p=E(),k=E(),x=E(0),b=()=>{t(),N(),_.value.click()},I=d=>{P();let n=d.target.files;o.originFile=n,O(n[0]),d.target.value=null},L=()=>{u.value=!0,P(),O(o.originFile)},T=()=>{u.value=!0,P(),O(o.originFile)},j=()=>{var d=document.createElement("a"),n=window.URL.createObjectURL(o.saveData);d.href=n,d.download=Math.floor(Math.random()*1e5)+".png",d.click(),window.URL.revokeObjectURL(n)},S=()=>{x.value=x.value?0:1,console.log(x.value)},V=()=>{r("changeMode")};return l({selectFile:b,saveToImg:j,changeFile:I,changePointNum:L,changeMarginRandom:T,switchImg:S}),(d,n)=>(G(),Y(J,null,[c("input",{type:"file",ref_key:"selector",ref:_,style:{display:"none"},onChange:I},null,544),c("div",me,[H(c("div",{class:"origin-img img-box",ref_key:"orginImg",ref:p},null,512),[[ee,x.value==0]]),H(c("div",{class:"lowpoly-img img-box",ref_key:"lowpolyImg",ref:k},null,512),[[ee,x.value==1]])]),c("div",ve,[c("div",pe,[c("div",_e,[c("p",null,"\u70B9\u6570 \u70B9\u6570\u8D8A\u591A\u8272\u5757\u8D8A\u5BC6\u96C6("+X(i(w.value))+")",1),H(c("input",{type:"range",min:m.value[0],max:m.value[1],"onUpdate:modelValue":n[0]||(n[0]=h=>w.value=h),onChange:L},null,40,be),[[oe,w.value]])]),c("div",ye,[c("p",null," \u8FB9\u7F18\u968F\u673A\u70B9\u6570\u6BD4,0-1\u8D8A\u5927\u8F6E\u5ED3\u8D8A\u6E05\u6670("+X(C.value/100)+") ",1),H(c("input",{type:"range",min:"1","onUpdate:modelValue":n[1]||(n[1]=h=>C.value=h),onChange:T},null,544),[[oe,C.value]])])]),c("div",{class:"btn-box"},[c("div",{class:"btn",onClick:b},"\u9009\u62E9\u56FE\u7247"),c("div",{class:"btn",onClick:j},"\u5B58\u4E3A\u56FE\u7247"),c("div",{class:"btn",onClick:S},"\u5207\u6362\u56FE\u7247"),c("div",{class:"btn",onClick:V},"\u5207\u6362\u6A21\u5F0F")])])],64))}}),Me=(e,l,r)=>{if(e==0||e==360)return[0,0,l,0];if(e==90)return[0,0,0,r];if(e==180)return[l,0,0,0];if(e==270)return[0,r,0,0];l=l/2,r=r/2;const o=Math.abs(e%90),t=Math.sqrt(l**2+r**2);let a=Math.atan(r/l),i=o*Math.PI/180,s=t*Math.cos(a-i),u=s*Math.cos(i),m=s*Math.sin(i);e<90?m*=-1:e<180?(m*=-1,u*=-1,[u,m]=[m,u]):e<270?u*=-1:[u,m]=[m,u];let w=-u,C=-m;return w=l+w,C=r-C,u=l+u,m=r-m,[w,C,u,m]};const xe={class:"show-box"},Ie=te({props:{width:{type:Number,default:0},height:{type:Number,default:0},angle:{type:Number,default:0},colorList:{type:Array,default:[]}},emits:["changeMode"],setup(e,{expose:l,emit:r}){const o=e;let t={originFile:null,imageData:null,saveData:null};function a(_,p,k,x){let b=_.data,I=(x*k+p)*4;var L=b[I],T=b[I+1],j=b[I+2],S=b[I+3];return[L,T,j,S]}E(!1),E([0,1e3]),E(1),E(1);function i(_,p){let k=_.width-1,x=_.height-1,b=[];b=[[0,0],[0,x],[k,0],[k,x]],((S=0,V=0)=>{let d=Math.sqrt(p),n=Math.sqrt(p);for(let h=0;h<d;h++){let v=Math.round(h*S/d);v>0&&(b.push([v,0]),b.push([v,V]))}for(let h=0;h<n;h++){let v=Math.round(h*V/n);v>0&&(b.push([0,v]),b.push([S,v]))}})(k,x);const L=Math.round(Math.sqrt(p));let T=k/L,j=x/L;for(let S=0;S<L;S++)for(let V=0;V<L;V++)b.push([Math.floor((S+Math.random())*T),Math.floor((V+Math.random())*j)]);return b}function s(){m.value.innerHTML="",w.value.innerHTML=""}function u(_,p){let k=document.createElement("canvas"),x=k.getContext("2d");k.width=_.width,k.height=_.height;for(var b=re.triangulate(p),I=b.length;I;){x.beginPath(),--I,x.moveTo(p[b[I]][0],p[b[I]][1]);let L=a(_,p[b[I]][0],p[b[I]][1],_.width);--I,x.lineTo(p[b[I]][0],p[b[I]][1]);let T=a(_,p[b[I]][0],p[b[I]][1],_.width);--I,x.lineTo(p[b[I]][0],p[b[I]][1]);let j=a(_,p[b[I]][0],p[b[I]][1],_.width),S=(L[0]+T[0]+j[0])/3,V=(L[1]+T[1]+j[1])/3,d=(L[2]+T[2]+j[2])/3,n=`rgba(${S}, ${V}, ${d}, ${L[3]})`;x.fillStyle=n,x.strokeStyle=n,x.fill(),x.closePath(),x.stroke()}k.toBlob(L=>{t.saveData=L}),w.value.appendChild(k)}const m=E(),w=E(),C=E(1),N=()=>{var _=document.createElement("a"),p=window.URL.createObjectURL(t.saveData);_.href=p,_.download=Math.floor(Math.random()*1e5)+".png",_.click(),window.URL.revokeObjectURL(p)},D=()=>{C.value=C.value?0:1,console.log(C.value)},M=E([]),y=(_="")=>{M.value.push(_)},R=(_,p,k)=>{let x=Me(o.angle,p,k);console.log(x);const b=_.createLinearGradient(x[0],x[1],x[2],x[3]),I=M.value.length;for(let L=0;L<I;L++){let T=L/(I-1);b.addColorStop(T,M.value[L])}_.fillStyle=b,_.fillRect(0,0,p,k)},P=E(20),O=()=>{s();const _=o.width,p=o.height;M.value=[];for(let T of o.colorList)T&&y(T);let k=document.createElement("canvas"),x=k.getContext("2d");k.width=_,k.height=p,R(x,_,p),m.value.appendChild(k);let b=x.getImageData(0,0,_,p);const I=Math.floor(_*p/1024/P.value);let L=i(b,I);u(b,L)},z=()=>{r("changeMode")};return l({saveToImg:N,switchImg:D}),(_,p)=>(G(),Y(J,null,[c("div",xe,[H(c("div",{class:"origin-img img-box",ref_key:"orginImg",ref:m},null,512),[[ee,C.value==0]]),H(c("div",{class:"lowpoly-img img-box",ref_key:"lowpolyImg",ref:w},null,512),[[ee,C.value==1]])]),c("div",{class:"bottom-box"},[c("div",{class:"btn-box"},[c("div",{class:"btn",onClick:O},"\u751F\u6210"),c("div",{class:"btn",onClick:N},"\u5B58\u4E3A\u56FE\u7247"),c("div",{class:"btn",onClick:D},"\u5207\u6362\u56FE\u7247"),c("div",{class:"btn",onClick:z},"\u5207\u6362\u6A21\u5F0F")])])],64))}});const Ce={class:"menu-bar"},ke={class:"menu-line"},Le=c("p",null,"\u65B9\u5411",-1),Ee=["value"],De={class:"menu-line"},Fe=c("p",null,"\u8D28\u91CF",-1),Ne=["value"],Pe={class:"menu-line"},Ae=c("p",null,"\u6E10\u53D8\u89D2\u5EA6",-1),Te={class:"menu-line"},Re=c("p",null,"\u989C\u8272",-1),$e={class:"color-list"},Se=["value","onChange"],Ue=te({setup(e,{expose:l}){const r=E(0),o=[{id:0,value:0,label:"16:9"},{id:1,value:1,label:"9:16"},{id:2,value:2,label:"1:1"}],t=E(1),a=[{id:0,value:0,label:"2k\u666E\u901A"},{id:1,value:1,label:"4k\u9AD8\u6E05"}],i=E("45"),s=Z(()=>{if(r.value==2)return t.value==1?[2048,2048]:[1024,1024];const D=t.value==1?2560:1920,M=t.value==1?1440:1080;return r.value==0?[D,M]:[M,D]}),u=E(["#223e9f","#c2ffd6","#29e0b0"]);function m(){const D=["#61649f","#1661ab","#2376b7","#5698c3","#29b7cb","#1ba784","#45b787","#229453","#43b244","#96c24e","#fed71a","#f1ca17","#fcd337","#f6c430","#fbb612","#f26b1f"],M=D.length-1;let y=Math.floor(Math.random()*M);return D[y]}const w=()=>{u.value.push(m())},C=(D,M)=>{let y=M.target.value;u.value[D]=y},N=()=>{u.value.length!=2&&u.value.splice(u.value.length-1,1)};return l({size:s,colorList:u,angle:i}),(D,M)=>(G(),Y("div",Ce,[c("div",ke,[Le,H(c("select",{"onUpdate:modelValue":M[0]||(M[0]=y=>r.value=y)},[(G(),Y(J,null,le(o,y=>c("option",{key:y.id,value:y.value},X(y.label),9,Ee)),64))],512),[[ae,r.value]])]),c("div",De,[Fe,H(c("select",{"onUpdate:modelValue":M[1]||(M[1]=y=>t.value=y)},[(G(),Y(J,null,le(a,y=>c("option",{key:y.id,value:y.value},X(y.label),9,Ne)),64))],512),[[ae,t.value]])]),c("div",Pe,[Ae,H(c("input",{type:"range",min:"0",max:"360",step:"5","onUpdate:modelValue":M[2]||(M[2]=y=>i.value=y)},null,512),[[oe,i.value]]),c("p",null,X(i.value),1)]),c("div",Te,[Re,c("div",$e,[c("div",{class:"color-btn",onClick:w},"+1"),c("div",{class:"color-btn",onClick:N},"-1"),(G(!0),Y(J,null,le(u.value,(y,R)=>(G(),Y("div",{class:"color-box",key:y},[c("input",{type:"color",value:y,onChange:P=>C(R,P)},null,40,Se)]))),128))])])]))}});const Be={key:0,class:"app"},Oe={key:1},je=te({setup(e){const l=E(),r=Z(()=>l.value&&l.value.size?l.value.size:[0,0]),o=Z(()=>l.value&&l.value.colorList?l.value.colorList:[]),t=Z(()=>l.value&&l.value.angle?l.value.angle-0:45),a=E(0),i=()=>{a.value=a.value==0?1:0};return ce(()=>{console.log(l.value.size)}),(s,u)=>a.value==0?(G(),Y("div",Be,[ne(Ie,{width:Q(r)[0],height:Q(r)[1],colorList:Q(o),angle:Q(t),onChangeMode:i},null,8,["width","height","colorList","angle"]),ne(Ue,{ref_key:"menuEl",ref:l},null,512)])):(G(),Y("div",Oe,[ne(we,{onChangeMode:i})]))}});de(je).mount("#app");
